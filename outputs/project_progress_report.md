# プロジェクトの進捗共有／状況報告のまとめ

## 概要

本ミーティングでは、POSTのshowアクションで発生したActiveRecordエラーの原因分析と修正内容、併せて実務視点でのデバッグ手順（仮説先行アプローチ、ブレークポイントの設置方針、切り分け方法）について整理・合意した。加えて、書く場合／話す場合のテンプレート活用により、デバッグ知見の蓄積と伝達精度を高める方針を確認した。

## 問題と解決

### 問題の症状

- POSTのshowアクションでActiveRecordエラーが発生。
- 画面上では投稿が閲覧できているように見える一方、DB上の該当レコード取得に失敗している矛盾が観測された。

### 原因

- 該当コードが「current_userのユーザーIDとpost IDが一致するもののみ」を検索対象としており、showアクション本来の「全ユーザーが該当投稿を閲覧可能」という要件と不整合だった。

### 誤認の切り分け（非原因の確認）

- format.htmlの役割を誤解していたが、これはレスポンス形式（HTML/JSON）を返すためのものであり、ID解決とは無関係であることを確認。
- params[:id]はURLから渡されるIDの格納であるため、当該不具合の主因ではないと判断。

### 修正内容

- 検索条件を「全投稿からIDで1件取得」へ是正（例：Post.find(params[:id])等、ユーザーに依存しない検索）。
- 想定SQLとの比較で挙動差を確認し、要件との整合を担保。

### 学び

- UI上の表示可否とDB検索のロジックは別レイヤーであるため、仕様（誰が閲覧できるか）に立ち返って検索スコープを設計する重要性を再認識。

## デバッグプロセスに関する洞察

### 仮説先行アプローチの重要性

- まず「起きている現象」「本来の正しい状態」「原因仮説」を言語化し、検証対象を絞り込む。
- ブレークポイントは「最後の確認（答え合わせ）」として用い、設置箇所を仮説に基づき限定する。

### ブレークポイント設置の方針

- MVCのデータ流れに沿って前後を比較し、どこまで値が渡っているかで「正常領域／異常領域」を切り分ける。
  - ここまで渡っている＝前段は正常
  - ここから渡っていない＝以降が怪しい
- 分岐点（ifなどの条件式）や、データが詰まりやすいポイント（受け渡しの境界、フィルタ／スコープ適用箇所）に焦点を当てる。

### 検証の順序

- 仮説立案→怪しい箇所の特定→必要最小限のブレークポイント設置→挙動確認→仮説の更新／確定。

### 知見の蓄積

- 「エラーが出やすい論点」（分岐、スコープ、パラメータ受け渡し、権限／認可）を個人のチェックリストとして蓄積し、次回以降の初動を高速化。

## コミュニケーションのテンプレートとスキル

### 書く場合（記述テンプレート：7項目の例）

1. 起きている現象
2. 本来の正しい状態（期待値）
3. 原因仮説
4. 検証方法（どこに何を置く／確認する）
5. 観察結果（ログ／ブレークポイントで見えた事実）
6. 結論（原因の特定と修正内容）
7. 次に活かす点（再発防止、チェックリスト化）

- できるところから埋めて習熟度を高め、フォーマットに沿って視点を蓄積する。

### 話す場合（三段階の説明＋5ポイント話法）

#### 三段階の説明

1. 非エンジニア向けに平易に要点を説明
2. エンジニア向けに専門用語を適切に用いて説明
3. 実務レベルで詳細（設計・コード・テスト）を説明

#### 5ポイント話法

1. 何を実現したかったか（目的）
2. どんな処理の流れか（設計／フロー）
3. 工夫点・意識したこと
4. なぜそうしたか（理由）
5. 課題・次につなげるポイント

- プルリクエストの説明にも5つの視点を適用すると、レビューの伝達効率が向上する。

## 決定

- showアクションの検索スコープを「ユーザー依存」から「全投稿対象」へ是正する方針を確認。
- デバッグは「仮説先行」で進め、ブレークポイントは必要最小限・仮説に基づく設置とする。
- 記述／話法テンプレートを継続活用し、知見を体系化する。

## リスクと障害

- ブレークポイントを無秩序に多用すると、調査範囲が拡散して時間がかかるリスク。
- レスポンス形式（format）やパラメータ受け渡しなど補助的要素の誤解により、原因の同定が遅延するリスク。
- 明確なブロッカーは現時点で無し。

## 対応事項

- [ ] @Speaker2: showアクションの検索条件を全投稿対象に修正し、RSpecで回帰テスト（権限／存在しないIDのケース含む）を追加する。
- [ ] @Speaker2: デバッグ開始時に原因仮説を明文化し、疑わしい箇所にのみブレークポイントを設置する運用を徹底する。
- [ ] @Speaker2: 記述テンプレート（7項目）でエラー解析メモを作成・蓄積し、次回までに1件共有する。
- [ ] @Speaker2: 5ポイント話法＋三段階の説明を用いて、1件分の口頭説明を練習（録音・自己レビュー）する。
- [ ] @Speaker1: 記述・話法テンプレートのサンプルを共有し、次回のフィードバック機会を設定する。
